<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gamification Core</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    <style>
        .modal.hidden, .menu-section-content.hidden, .quest-wizard-step.hidden { display: none; }
        .modal { resize: both; overflow: auto; border: 2px solid #4a5568; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        #character-sidebar .sidebar-content { max-height: calc(100vh - 4rem); overflow-y: auto; }
        .achievement-icon-selector.selected { outline: 2px solid #f59e0b; background-color: #374151; }
        .gantt-quest-bar { position: absolute; height: 80%; top: 10%; border-radius: 0.25rem; cursor: grab; display: flex; align-items: center; justify-content: space-between; padding-left: 0.5rem; padding-right: 0.25rem; font-size: 0.75rem; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; border: 1px solid rgba(0,0,0,0.3); }
        .gantt-quest-bar:active { cursor: grabbing; }
        .gantt-quest-bar.project { height: 10px; top: calc(50% - 5px); background-color: #9ca3af; border-radius: 0; }
        .quest-conflict { border: 2px solid #ef4444; box-shadow: 0 0 8px #ef4444; }
        #focus-timer-visual-fill { transition: height 0.5s linear; }
        .text-shadow { text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7); }
        .wizard-progress-dot { width: 10px; height: 10px; border-radius: 50%; background-color: #4b5567; transition: background-color 0.3s; }
        .wizard-progress-dot.active { background-color: #6366f1; }
        @keyframes blink { 50% { border-color: #ef4444; } }
        #main-content.blinking-border { animation: blink 1.5s linear infinite; border-style: solid; border-width: 2px; border-color: #4b5567; }
        .gantt-conflict-segment { position: absolute; height: 100%; top: 0; background-image: repeating-linear-gradient(45deg, rgba(239, 68, 68, 0.4), rgba(239, 68, 68, 0.4) 5px, transparent 5px, transparent 10px); pointer-events: none; }
        .pet-selector.selected { border-color: #f59e0b; box-shadow: 0 0 10px #f59e0b; background-color: #374151; }
    </style>
    <style id="skills-styles">
        .skill-node {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem;
            border: 2px solid #4b5567;
            border-radius: 0.5rem;
            background-color: #374151;
            transition: all 0.2s;
            cursor: pointer;
        }
        .skill-node.selected {
            border-color: #6366f1;
            background-color: #4338ca;
        }
        .skill-node--locked {
            opacity: 0.5;
            background-color: #1f2937;
        }
        .skill-node--learnable {
            border-color: #f59e0b;
        }
        .skill-node--learnable:hover {
            background-color: #4b5567;
        }
        .skill-node--unlocked {
            border-color: #22c55e;
            background-color: #166534;
        }
        .skill-icon {
            font-size: 1.5rem;
            width: 2.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.375rem;
            background-color: rgba(0,0,0,0.2);
        }
    </style>
    <style id="equipment-styles">
        .equipment-slot { background-color: #111827; border: 2px solid #4b5567; aspect-ratio: 1/1; display: flex; align-items: center; justify-content: center; transition: all 0.2s; cursor: pointer; transform: rotate(45deg); border-radius: 0.375rem; }
        .equipment-slot:hover { border-color: #9ca3af; background-color: #1f2937; }
        .equipment-slot.selected { border-color: #f59e0b; box-shadow: 0 0 10px #f59e0b; }
        .equipment-slot.blocked { background-color: #374151; cursor: not-allowed; }
        .equipment-slot > * { text-align: center; line-height: 1; transform: rotate(-45deg); }
        .slot-medium { width: 5rem; height: 5rem; }
        .slot-small { width: 4.5rem; height: 4.5rem; }
    </style>
    <style id="my-quests-styles">
        .quest-filter-btn.active { background-color: #4f46e5; font-weight: bold; }
    </style>
    <style id="inventory-styles">
        #inventory-list-container .group.selected { background-color: #3b82f6; border: 1px solid #60a5fa; }
    </style>
    <style id="pets-styles">
        #pets-inventory-list .active-pet-glow { box-shadow: 0 0 12px #f59e0b, inset 0 0 8px rgba(245, 158, 11, 0.5); }
    </style>
    <style id="journal-styles"></style>
    <style id="character-stats-styles"></style>
</head>
<body class="bg-gray-900 text-gray-200">

    <div id="global-currency-display" class="fixed top-4 right-4 z-50 flex gap-4 text-sm">
       <div class="flex items-center gap-1 p-2 bg-gray-800 rounded-lg border border-gray-600">
           <span title="Kristalle">üíé</span><span id="crystals-amount">0</span>
       </div>
       <div class="flex items-center gap-1 p-2 bg-gray-800 rounded-lg border border-gray-600">
           <span title="Gold">üí∞</span><span id="gold-amount">0</span>
       </div>
       <div class="flex items-center gap-1 p-2 bg-gray-800 rounded-lg border border-gray-600">
           <span title="Silber">ü™ô</span><span id="silver-amount">0</span>
       </div>
       <div class="flex items-center gap-1 p-2 bg-gray-800 rounded-lg border border-gray-600">
           <span title="Bronze">ü•â</span><span id="bronze-amount">0</span>
       </div>
    </div>

    <!-- Minimized Break Timer -->
    <div id="minimized-break-timer" class="hidden fixed top-4 left-1/2 -translate-x-1/2 z-50 bg-gray-700 text-white p-2 rounded-lg shadow-lg border border-gray-500">
        <span>Pause: </span><span id="minimized-break-timer-display" class="font-mono">05:00</span>
    </div>


    <div class="min-h-screen flex items-center justify-center p-4">
        <!-- Auth View -->
        <div id="auth-view">
            <div class="bg-gray-800 p-8 rounded-lg shadow-lg text-center max-w-md mx-auto">
                <h1 class="text-white text-3xl font-bold mb-6">Willkommen!</h1>
                <button id="login-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                    Anonym Anmelden
                </button>
            </div>
        </div>

        <!-- App View -->
        <div id="app-view" class="hidden w-full max-w-screen-xl mx-auto flex gap-4">
            <!-- Left Menu -->
            <div id="main-menu-container" class="w-48 flex-shrink-0 bg-gray-800 p-4 rounded-lg shadow-lg flex flex-col gap-4">
                 <h2 class="text-xl font-bold text-center border-b border-gray-600 pb-2">Men√º</h2>
                 
                 <div class="menu-section">
                    <h3 class="menu-section-header text-lg font-semibold cursor-pointer border-b border-gray-700 pb-1 mb-2">Produktion</h3>
                    <div class="menu-section-content pl-2 flex flex-col gap-2">
                        <button id="menu-btn-new-quest" class="menu-btn bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">Neue Quest</button>
                        <button id="menu-btn-simple-quest" class="menu-btn bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-1 px-2 rounded-lg transition duration-300 text-xs">Simple Quest (Test)</button>
                        <button id="menu-btn-my-quests" class="menu-btn bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                            Meine Quests
                            <div id="my-quests-counts" class="flex justify-center items-center gap-2 text-xs mt-1"></div>
                        </button>
                        <button id="menu-btn-journal" class="menu-btn bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">Journal</button>
                    </div>
                 </div>

                <div class="menu-section">
                    <h3 class="menu-section-header text-lg font-semibold cursor-pointer border-b border-gray-700 pb-1 mb-2">Gamification</h3>
                    <div class="menu-section-content pl-2 flex flex-col gap-2">
                        <button id="menu-btn-pets" class="menu-btn bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">Pets</button>
                    </div>
                </div>


                 <div class="mt-auto border-t border-gray-600 pt-4 space-y-2">
                     <h3 class="text-xs text-gray-400 text-center">Test-Tools</h3>
                     <div id="test-buttons-container" class="flex flex-col gap-2">
                         <button id="test-levelup-btn" class="text-xs bg-yellow-600 hover:bg-yellow-500 p-1 rounded">Level Up</button>
                         <button id="test-add-bronze-btn" class="text-xs bg-yellow-700 hover:bg-yellow-600 p-1 rounded">+125 Bronze</button>
                         <button id="test-gantt-btn" class="text-xs bg-teal-600 hover:bg-teal-500 p-1 rounded">Test Gantt</button>
                         <button id="test-add-today-quests-btn" class="text-xs bg-blue-600 hover:bg-blue-500 p-1 rounded">+5 Quests f√ºr Heute</button>
                         <button id="test-complete-all-quests-btn" class="text-xs bg-red-600 hover:bg-red-500 p-1 rounded">Alle Quests erledigen</button>
                         <button id="test-simulate-drop-btn" class="text-xs bg-orange-600 hover:bg-orange-500 p-1 rounded">Simulate Drop</button>
                         <button id="test-gain-pet-xp-btn" class="text-xs bg-purple-600 hover:bg-purple-500 p-1 rounded">+50 Pet XP</button>
                         <button data-count="5" data-priority="Leicht" class="add-test-quests-btn text-xs bg-gray-600 hover:bg-gray-500 p-1 rounded">+5 Leicht</button>
                         <button data-count="5" data-priority="Mittel" class="add-test-quests-btn text-xs bg-gray-600 hover:bg-gray-500 p-1 rounded">+5 Mittel</button>
                         <button data-count="5" data-priority="Schwer" class="add-test-quests-btn text-xs bg-gray-600 hover:bg-gray-500 p-1 rounded">+5 Schwer</button>
                     </div>
                 </div>

                 <div class="mt-4">
                    <button id="logout-btn" class="w-full bg-red-800 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">Abmelden & L√∂schen</button>
                 </div>
            </div>

            <!-- Main Content -->
            <div id="main-content-container" class="flex-grow flex flex-col gap-4">
                <div class="bg-gray-800 p-4 rounded-lg shadow-lg text-white flex flex-col h-[350px]">
                    <div class="flex justify-between items-center mb-2 flex-shrink-0">
                        <h3 class="font-bold text-lg">Projekt-√úbersicht</h3>
                        <div id="gantt-controls" class="flex items-center gap-4 text-sm">
                            <label>Projekt: 
                                <select id="gantt-project-filter" class="bg-gray-900 rounded p-1">
                                    <option value="">Alle</option>
                                </select>
                            </label>
                            <label>Startzeit: <input type="time" id="gantt-start-time" value="16:00" step="900" class="bg-gray-900 rounded p-1"></label>
                            <label>Datum: <input type="date" id="gantt-date" class="bg-gray-900 rounded p-1"></label>
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="checkbox" id="gantt-auto-pause-toggle">
                                <span>Auto. Pause</span>
                            </label>
                            <div class="border-l border-gray-600 pl-4">
                                <select id="gantt-view-select" class="bg-gray-700 text-white border-gray-600 rounded p-1 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    <option value="day">Tagesansicht</option>
                                    <option value="week">Wochenansicht</option>
                                    <option value="single-line">Eine Zeile</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="flex-grow overflow-auto">
                        <div id="gantt-chart-container" class="grid grid-cols-[250px_1fr] text-sm gap-y-1 relative">
                        </div> 
                    </div>
                </div>
                
                <div id="main-content" class="bg-gray-800 p-6 rounded-lg shadow-lg text-white flex-grow">
                     <div id="focus-quest-container">
                     </div>
                </div>
            </div>
            
            <!-- Right Character Sidebar -->
            <div id="character-sidebar" class="w-96 flex-shrink-0 bg-gray-800 p-4 rounded-lg shadow-lg flex flex-col">
                <div class="sidebar-content overflow-y-auto">
                    <div class="text-center mb-4">
                        <div class="flex justify-center items-center gap-2">
                           <h2 id="character-name" class="text-xl font-bold"></h2>
                           <span class="text-sm font-bold text-green-400">(Level <span id="character-level">1</span>)</span>
                        </div>
                        <div id="character-achievements-display" class="flex justify-center flex-wrap gap-1 mt-1 h-6"></div>
                        <img id="character-image" src="https://placehold.co/128x128/374151/e5e7eb.png?text=Charakter" alt="Character Portrait" class="mx-auto my-2 rounded-lg border-2 border-gray-600">
                        <div id="active-pets-sidebar" class="flex justify-center items-center gap-2 mt-2 h-8"></div>
                    </div>
                
                    <div id="ui-block-player-info">
                         <div class="mt-2 space-y-3">
                            <div class="flex items-center">
                                <div class="flex-grow">
                                    <span class="text-sm font-bold text-red-400">HP</span>
                                    <div class="w-full bg-gray-600 rounded-full h-4 relative border border-gray-500">
                                        <div id="hp-bar-fill" class="bg-red-500 h-full rounded-full" style="width: 100%;"></div>
                                        <span id="hp-bar-text" class="absolute inset-0 text-white text-xs font-bold flex items-center justify-center">100 / 100</span>
                                    </div>
                                </div>
                                <button id="use-hp-potion-btn" class="group flex items-center gap-1 ml-3 flex-shrink-0" title="Heiltrank benutzen">
                                    <span class="text-lg transition-transform group-hover:scale-125">üß™</span>
                                    <span id="hp-potion-count" class="text-sm font-bold min-w-[1rem] text-center">0</span>
                                </button>
                            </div>
                             <div class="flex items-center">
                                <div class="flex-grow">
                                    <span class="text-sm font-bold text-blue-400">Mana</span>
                                    <div class="w-full bg-gray-600 rounded-full h-4 relative border border-gray-500">
                                        <div id="mana-bar-fill" class="bg-blue-500 h-full rounded-full" style="width: 100%;"></div>
                                        <span id="mana-bar-text" class="absolute inset-0 text-white text-xs font-bold flex items-center justify-center">100 / 100</span>
                                    </div>
                                </div>
                                <button id="use-mana-potion-btn" class="group flex items-center gap-1 ml-3 flex-shrink-0" title="Manatrank benutzen">
                                    <span class="text-lg transition-transform group-hover:scale-125">üíß</span>
                                    <span id="mana-potion-count" class="text-sm font-bold min-w-[1rem] text-center">0</span>
                                </button>
                            </div>
                             <div>
                                 <span class="text-sm font-bold text-green-400">Ausdauer</span>
                                 <div class="w-full bg-gray-600 rounded-full h-4 relative border border-gray-500">
                                     <div id="stamina-bar-fill" class="bg-green-500 h-full rounded-full" style="width: 100%;"></div>
                                     <span id="stamina-bar-text" class="absolute inset-0 text-white text-xs font-bold flex items-center justify-center">100 / 100</span>
                                 </div>
                             </div>
                        </div>
                        <div id="xp-section" class="mt-4">
                            <div id="xp-bar-container" class="w-full bg-gray-600 rounded-full h-2.5">
                                <div id="xp-bar-progress" class="bg-yellow-400 h-2.5 rounded-full" style="width: 0%"></div>
                            </div>
                            <p class="text-sm text-right text-gray-300 mt-1">
                                <span id="xp-current-in-level">0</span> / <span id="xp-needed-for-level">100</span> XP
                            </p>
                        </div>
                    </div>
                     <hr class="my-4 border-gray-600">

                     <div class="grid grid-cols-2 gap-2 my-4">
                         <button id="menu-btn-equipment" class="menu-btn bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-2 rounded-lg transition duration-300 text-sm">Ausr√ºstung</button>
                         <button id="menu-btn-inventory" class="menu-btn bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-2 rounded-lg transition duration-300 text-sm">Inventar</button>
                         <button id="menu-btn-achievements" class="menu-btn bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-2 rounded-lg transition duration-300 text-sm">Erfolge</button>
                         <button id="open-skills-btn" class="menu-btn bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-2 rounded-lg transition duration-300 text-sm">Skills</button>
                     </div>
                     
                     <div class="flex gap-4">
                        <div id="ui-block-character-stats" class="space-y-3 text-left flex-1">
                             <h3 class="text-lg font-bold text-center mb-2">Attribute</h3>
                            <div class="flex justify-between items-center text-sm"><span><span>‚ù§Ô∏è</span> Vitalit√§t: <span id="stat-vitality">10</span></span><div class="flex items-center relative gap-1"><button data-stat="vitality" data-amount="1" class="stat-increase-btn hidden bg-green-500 hover:bg-green-600 px-2 rounded text-xs">+</button><button data-stat="vitality" data-amount="5" class="stat-increase-btn hidden bg-blue-500 hover:bg-blue-600 px-2 rounded text-xs">+5</button></div></div>
                            <div class="flex justify-between items-center text-sm"><span><span>üí™</span> St√§rke: <span id="stat-strength">10</span></span><div class="flex items-center relative gap-1"><button data-stat="strength" data-amount="1" class="stat-increase-btn hidden bg-green-500 hover:bg-green-600 px-2 rounded text-xs">+</button><button data-stat="strength" data-amount="5" class="stat-increase-btn hidden bg-blue-500 hover:bg-blue-600 px-2 rounded text-xs">+5</button></div></div>
                            <div class="flex justify-between items-center text-sm"><span><span>ü§∏</span> Agilit√§t: <span id="stat-agility">10</span></span><div class="flex items-center relative gap-1"><button data-stat="agility" data-amount="1" class="stat-increase-btn hidden bg-green-500 hover:bg-green-600 px-2 rounded text-xs">+</button><button data-stat="agility" data-amount="5" class="stat-increase-btn hidden bg-blue-500 hover:bg-blue-600 px-2 rounded text-xs">+5</button></div></div>
                            <div class="flex justify-between items-center text-sm"><span><span>üß†</span> Intelligenz: <span id="stat-int">10</span></span><div class="flex items-center relative gap-1"><button data-stat="int" data-amount="1" class="stat-increase-btn hidden bg-green-500 hover:bg-green-600 px-2 rounded text-xs">+</button><button data-stat="int" data-amount="5" class="stat-increase-btn hidden bg-blue-500 hover:bg-blue-600 px-2 rounded text-xs">+5</button></div></div>
                            <div class="flex justify-between items-center text-sm"><span><span>üèÉ</span> Ausdauer: <span id="stat-stamina">10</span></span><div class="flex items-center relative gap-1"><button data-stat="stamina" data-amount="1" class="stat-increase-btn hidden bg-green-500 hover:bg-green-600 px-2 rounded text-xs">+</button><button data-stat="stamina" data-amount="5" class="stat-increase-btn hidden bg-blue-500 hover:bg-blue-600 px-2 rounded text-xs">+5</button></div></div>
                            <div class="flex justify-between items-center text-sm"><span><span>üçÄ</span> Gl√ºck: <span id="stat-luck">10</span></span><div class="flex items-center relative gap-1"><button data-stat="luck" data-amount="1" class="stat-increase-btn hidden bg-green-500 hover:bg-green-600 px-2 rounded text-xs">+</button><button data-stat="luck" data-amount="5" class="stat-increase-btn hidden bg-blue-500 hover:bg-blue-600 px-2 rounded text-xs">+5</button></div></div>
                        </div>
                        <div id="sidebar-derived-stats" class="space-y-2 text-left text-sm flex-1">
                            <h3 class="text-lg font-bold text-center mb-2">Kampfwerte</h3>
                            <p>Physischer Dmg: <span id="derived-stat-phys-dmg" class="font-bold text-green-400">0</span></p>
                            <p>Verteidigung: <span id="derived-stat-def" class="font-bold text-green-400">0</span></p>
                            <p>Ausweichen: <span id="derived-stat-dodge" class="font-bold text-green-400">0%</span></p>
                            <p>Elementar Dmg: <span id="derived-stat-ele-dmg" class="font-bold text-green-400">0</span></p>
                        </div>
                     </div>

                     <p id="stat-points-container" class="text-center mt-4 hidden pt-2 border-t border-gray-600">Punkte zu vergeben: <span id="stat-points-display-footer">0</span></p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Notification Area -->
    <div id="notification-area" class="fixed top-5 right-5 bg-blue-500 text-white p-3 rounded-lg shadow-lg opacity-0 transition-opacity duration-500 z-50"></div>

    <!-- #################### -->
    <!-- ## FLOATING MODALS ## -->
    <!-- #################### -->

    <!-- My Quests Modal -->
    <div id="my-quests-modal" class="modal hidden fixed top-1/4 left-1/3 w-[800px] h-[70vh] z-40">
        <div class="bg-gray-800 text-white rounded-lg h-full flex flex-col">
             <div class="p-4 pb-2 flex justify-between items-center cursor-move modal-header relative">
                <h3 class="font-bold">Meine Quests</h3>
                <button class="modal-close-btn absolute top-2 right-2 text-2xl font-bold hover:text-red-500">&times;</button>
            </div>
            <div id="quest-list-filters" class="p-2 flex items-center gap-4 border-b border-gray-700 text-sm">
                <label>Sortieren nach:
                    <select id="quest-sort-select" class="bg-gray-900 rounded p-1">
                        <option value="priority">Priorit√§t</option>
                        <option value="createdAt">Erstellt am</option>
                        <option value="text">Titel</option>
                        <option value="xp">XP</option>
                    </select>
                </label>
                <div class="border-l border-gray-600 pl-4 flex gap-2">
                    <button data-filter="all" class="quest-filter-btn px-2 py-1 bg-indigo-600 rounded text-sm active">Alle</button>
                    <button data-filter="dueToday" class="quest-filter-btn px-2 py-1 bg-gray-600 rounded text-sm">Heute f√§llig</button>
                    <button data-filter="dueThisWeek" class="quest-filter-btn px-2 py-1 bg-gray-600 rounded text-sm">Woche f√§llig</button>
                </div>
            </div>
            <div id="todo-list" class="p-4 space-y-2 overflow-y-auto flex-grow"></div>
        </div>
    </div>

    <!-- New Quest Modal -->
    <div id="new-quest-modal" class="modal hidden fixed top-1/4 left-1/3 w-[600px] z-40">
        <div class="bg-gray-800 text-white rounded-lg h-full flex flex-col">
            <div class="p-4 pb-2 flex justify-between items-center cursor-move modal-header relative">
                <h3 class="font-bold">Neue Quest erstellen</h3>
                <button class="modal-close-btn absolute top-2 right-2 text-2xl font-bold hover:text-red-500">&times;</button>
            </div>
            <div class="p-4 overflow-y-auto">
                 <form id="add-todo-form" class="space-y-4 text-sm">
                    <!-- Step 1: Type -->
                     <div id="quest-step-1" class="quest-wizard-step space-y-4">
                        <h4 class="text-lg font-semibold text-center text-gray-400">Schritt 1: Typ</h4>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1">Typ</label>
                            <select id="todo-task-type" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                <option value="Aufgabe">Aufgabe</option>
                                <option value="Projektaufgabe">Projektaufgabe</option>
                                <option value="Projekt">Projekt</option>
                            </select>
                        </div>
                        <div id="todo-parent-project-container" class="hidden">
                             <label class="block text-xs font-medium text-gray-400 mb-1">√úbergeordnetes Projekt</label>
                             <select id="todo-parent-project" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                 <option value="">Kein Projekt ausgew√§hlt</option>
                             </select>
                         </div>
                    </div>
                    <!-- Step 2: Basic Info -->
                    <div id="quest-step-2" class="quest-wizard-step hidden space-y-4">
                        <h4 class="text-lg font-semibold text-center text-gray-400">Schritt 2: Titel & Beschreibung</h4>
                        <input type="text" id="todo-input" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="Quest-Titel..." required>
                        <div>
                            <button type="button" id="toggle-details-btn" class="text-sm text-indigo-400 hover:text-indigo-300">Beschreibung hinzuf√ºgen +</button>
                            <div id="details-toggle-content" class="hidden mt-2">
                                <textarea id="todo-details" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2 h-24 focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="Zus√§tzliche Notizen, Ziele oder Template-Text..."></textarea>
                            </div>
                        </div>
                    </div>
                    <!-- Step 3: Duration -->
                     <div id="quest-step-3" class="quest-wizard-step hidden space-y-4">
                        <h4 class="text-lg font-semibold text-center text-gray-400">Schritt 3: Dauer (Pflichtfeld)</h4>
                        <div id="duration-container-task">
                            <div class="flex justify-between items-center mb-2">
                                <label class="block text-xs font-medium text-gray-400">Dauer</label>
                                <button type="button" id="duration-mode-toggle" class="text-xs text-indigo-400 hover:text-indigo-300">Manuelle Eingabe</button>
                            </div>
                            <div id="Bearbeitungsdauer-Pomodoro">
                                <div class="flex items-center gap-4 p-2 bg-gray-900 rounded-lg">
                                    <span id="quest-duration-display" class="font-mono text-2xl font-bold text-white">0m</span>
                                    <div class="flex-grow flex justify-end gap-2">
                                        <button type="button" data-add-duration="25" class="duration-add-btn bg-blue-600 hover:bg-blue-500 rounded px-3 py-1">+25m</button>
                                        <button type="button" data-add-duration="45" class="duration-add-btn bg-blue-600 hover:bg-blue-500 rounded px-3 py-1">+45m</button>
                                        <button type="button" id="duration-reset-btn" class="bg-red-600 hover:bg-red-500 rounded px-3 py-1">Reset</button>
                                    </div>
                                </div>
                            </div>
                            <div id="Bearbeitungsdauer-Frei" class="hidden">
                                <input type="text" id="quest-duration-free-input" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2" placeholder="z.B. 1h 30m, 90m, 2h...">
                            </div>
                        </div>
                        <div id="duration-container-project" class="hidden">
                            <label class="block text-xs font-medium text-gray-400 mb-1">Dauer (Tage)</label>
                            <input type="number" id="project-duration-days" min="1" value="7" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2">
                        </div>
                    </div>
                     <!-- Step 4: Deadline & Repeat -->
                      <div id="quest-step-4" class="quest-wizard-step hidden space-y-4">
                        <h4 class="text-lg font-semibold text-center text-gray-400">Schritt 4: Deadline & Wiederholung</h4>
                         <div id="deadline-container">
                            <label class="block text-xs font-medium text-gray-400 mb-1">Deadline (Pflichtfeld)</label>
                            <input type="date" id="todo-deadline" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2">
                        </div>
                        <div id="start-date-container" class="hidden">
                            <label class="block text-xs font-medium text-gray-400 mb-1">Start-Datum (Pflichtfeld)</label>
                            <input type="date" id="project-start-date" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2">
                        </div>
                        <div class="pt-2" id="repeat-section">
                            <label class="flex items-center gap-2">
                                <input type="checkbox" id="todo-repeat" class="form-checkbox bg-gray-700 border-gray-600 text-indigo-500 focus:ring-indigo-500">
                                <span>T√§gliche Quest? (Wiederholbar)</span>
                            </label>
                            <div id="todo-repeat-options-container" class="hidden mt-2 space-y-2">
                                <p class="text-xs text-yellow-400 p-2 bg-yellow-900 bg-opacity-40 rounded-lg">T√§gliche Quests sind immer 'Leicht', geben +30 Bronze und kosten 5 HP, wenn sie verpasst werden.</p>
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1">Startzeit (Pflichtfeld)</label>
                                    <input type="time" id="todo-start-time" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2">
                                </div>
                                <div id="todo-repeat-days-container" class="flex flex-wrap gap-x-3 gap-y-1 text-sm text-gray-300"></div>
                            </div>
                        </div>
                    </div>
                    <!-- Step 5: Details -->
                     <div id="quest-step-5" class="quest-wizard-step hidden space-y-4">
                         <h4 class="text-lg font-semibold text-center text-gray-400">Schritt 5: Details</h4>
                         <div id="priority-container">
                            <label class="block text-xs font-medium text-gray-400 mb-1">Priorit√§t</label>
                            <select id="todo-priority" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                <option value="Leicht">Leicht</option>
                                <option value="Mittel" selected>Mittel</option>
                                <option value="Schwer">Schwer</option>
                            </select>
                        </div>
                        <div>
                             <label class="block text-sm font-medium text-gray-400 mb-2">Tag (1 ausw√§hlen)</label>
                            <div id="todo-tags-container" class="flex flex-wrap gap-x-4 gap-y-2 p-2 rounded-lg border border-transparent"></div>
                        </div>
                    </div>
                </form>
                <div id="quest-wizard-progress" class="flex justify-center gap-2 mt-4"></div>
                <div id="quest-wizard-nav" class="mt-6 flex justify-between">
                    <button id="quest-back-btn" class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg transition duration-300">Zur√ºck</button>
                    <button id="quest-next-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 disabled:bg-gray-500 disabled:cursor-not-allowed" disabled>Weiter</button>
                    <button id="quest-submit-btn" type="submit" form="add-todo-form" class="hidden bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">Quest Hinzuf√ºgen</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Journal Modal -->
    <div id="journal-modal" class="modal hidden fixed top-1/4 left-1/2 w-[500px] z-40">
        <div class="bg-gray-800 text-white rounded-lg h-full flex flex-col">
             <div class="p-4 pb-2 flex justify-between items-center cursor-move modal-header relative">
                <h3 class="font-bold">Journal</h3>
                <button class="modal-close-btn absolute top-2 right-2 text-2xl font-bold hover:text-red-500">&times;</button>
            </div>
            <div id="journal-list" class="p-4 space-y-2 overflow-y-auto"></div>
        </div>
    </div>
    
    <!-- Achievements Modal -->
    <div id="achievements-modal" class="modal hidden fixed top-1/4 left-1/2 w-[700px] z-40 ">
        <div class="bg-gray-800 text-white rounded-lg h-full flex flex-col relative">
            <div class="p-4 pb-2 flex justify-between items-center cursor-move modal-header">
                <h3 class="font-bold">Erfolge</h3>
                <button class="modal-close-btn text-xl font-bold hover:text-red-500">&times;</button>
            </div>
            <div class="flex p-4 flex-grow gap-4 overflow-hidden">
                <div id="achievements-list" class="w-5/6 space-y-3 overflow-y-auto pr-2"></div>
                <div class="w-1/6 border-l border-gray-600 pl-4">
                    <h4 class="text-sm font-bold text-gray-400 mb-2 text-center">Angezeigte Symbole</h4>
                    <div id="achievement-icons-selection" class="flex flex-wrap gap-2 justify-center"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Equipment Modal -->
    <div id="equipment-modal" class="modal hidden fixed top-1/4 left-1/3 w-[1035px] h-[750px] z-40">
        <div class="bg-gray-800 text-white rounded-lg h-full flex flex-col relative">
            <div class="p-4 pb-2 flex justify-between items-center">
                <h3 class="font-bold cursor-move modal-header flex-grow">Ausr√ºstung</h3>
                <button id="unequip-all-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded-lg text-xs mr-4">Alles ablegen</button>
                <button class="modal-close-btn absolute top-2 right-2 text-2xl font-bold hover:text-red-500">&times;</button>
            </div>
             <div id="equipment-slots-container" class="flex p-4 flex-grow gap-4 overflow-auto">
                 <!-- Column 1: Weapons, Tools & Stats -->
                <div class="w-1/3 flex-shrink-0 flex flex-col gap-4">
                    <div>
                        <h4 class="text-lg font-bold text-gray-400 text-center mb-4">Waffen & Werkzeuge</h4>
                        <div class="grid grid-cols-2 grid-rows-2 gap-4 w-full justify-items-center items-center pt-4">
                            <div data-slot-type="weapon1" class="equipment-slot w-32 h-32 text-gray-400">Waffe 1</div>
                            <div data-slot-type="weapon2" class="equipment-slot w-32 h-32 text-gray-400">Waffe 2</div>
                            <div data-slot-type="tool1" class="equipment-slot slot-medium text-gray-400">Werkzeug 1</div>
                            <div data-slot-type="tool2" class="equipment-slot slot-medium text-gray-400">Werkzeug 2</div>
                        </div>
                    </div>
                    <div id="equipment-item-details" class="bg-gray-900 p-4 rounded-lg border border-gray-600 mt-4 flex-grow"></div>
                </div>
                <!-- Column 2: Armor -->
                <div class="w-2/3 flex-shrink-0 flex flex-col gap-4">
                     <h4 class="text-lg font-bold text-gray-400 text-center mb-4">R√ºstung & Schmuck</h4>
                     <div class="grid grid-cols-3 gap-y-2 gap-x-2 justify-items-center items-center w-full h-full">
                        <div></div>
                        <div data-slot-type="head" class="equipment-slot w-24 h-24 text-gray-400">Kopf</div>
                        <div></div>
                        <div></div>
                        <div data-slot-type="amulet" class="equipment-slot slot-small text-gray-400">Amulett</div>
                        <div></div>
                        <div data-slot-type="hands" class="equipment-slot w-24 h-24 text-gray-400 -mt-4">H√§nde</div>
                        <div data-slot-type="chest" class="equipment-slot w-24 h-24 text-gray-400 -mt-4">Brust</div>
                        <div data-slot-type="bracers" class="equipment-slot w-24 h-24 text-gray-400 -mt-4">Armschienen</div>
                        <div data-slot-type="ring1" class="equipment-slot slot-small text-gray-400">Ring 1</div>
                        <div data-slot-type="legs" class="equipment-slot w-24 h-24 text-gray-400">Beine</div>
                        <div data-slot-type="ring2" class="equipment-slot slot-small text-gray-400">Ring 2</div>
                        <div></div>
                        <div data-slot-type="feet" class="equipment-slot w-24 h-24 text-gray-400">F√º√üe</div>
                        <div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Pomodoro Timer Modal -->
    <div id="pomodoro-modal" class="modal hidden fixed top-1/4 left-1/3 w-[400px] z-40">
        <div class="bg-gray-800 text-white rounded-lg h-full flex flex-col">
            <div class="p-4 pb-2 flex justify-between items-center cursor-move modal-header relative">
                <h3 class="font-bold">Pomodoro Timer</h3>
                <button class="modal-close-btn absolute top-2 right-2 text-2xl font-bold hover:text-red-500">&times;</button>
            </div>
            <div class="p-4 flex flex-col items-center">
                <div id="timer-display" class="text-6xl font-mono text-center my-4">25:00</div>
                <p id="timer-mode-display" class="mb-4 text-gray-400">Modus: Arbeit</p>
                <div class="mb-4">
                    <h4 class="text-sm font-bold mb-2 text-center text-gray-300">Arbeit</h4>
                    <div class="flex gap-2">
                        <button class="timer-select-btn px-3 py-1 bg-blue-600 hover:bg-blue-500 rounded text-sm" data-minutes="25" data-mode="Arbeit">25 Min</button>
                        <button class="timer-select-btn px-3 py-1 bg-blue-600 hover:bg-blue-500 rounded text-sm" data-minutes="45" data-mode="Arbeit">45 Min</button>
                    </div>
                </div>
                 <div class="mb-6">
                    <h4 class="text-sm font-bold mb-2 text-center text-gray-300">Pause</h4>
                    <div class="flex gap-2">
                        <button class="timer-select-btn px-3 py-1 bg-green-600 hover:bg-green-500 rounded text-sm" data-minutes="5" data-mode="Pause">5 Min</button>
                        <button class="timer-select-btn px-3 py-1 bg-green-600 hover:bg-green-500 rounded text-sm" data-minutes="10" data-mode="Pause">10 Min</button>
                         <button class="timer-select-btn px-3 py-1 bg-green-600 hover:bg-green-500 rounded text-sm" data-minutes="30" data-mode="Pause">30 Min</button>
                    </div>
                </div>
                <div class="flex gap-4">
                    <button id="timer-start-btn" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-500 rounded font-bold">Start</button>
                    <button id="timer-pause-btn" class="px-4 py-2 bg-yellow-600 hover:bg-yellow-500 rounded font-bold">Pause</button>
                    <button id="timer-reset-btn" class="px-4 py-2 bg-red-600 hover:bg-red-500 rounded font-bold">Reset</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Inventory Modal -->
    <div id="inventory-modal" class="modal hidden fixed top-1/4 left-1/2 w-[700px] h-[500px] z-40">
        <div class="bg-gray-800 text-white rounded-lg h-full flex flex-col">
            <div class="p-4 pb-2 flex justify-between items-center cursor-move modal-header relative">
                 <h3 class="font-bold">Inventar</h3>
                <button class="modal-close-btn absolute top-2 right-2 text-2xl font-bold hover:text-red-500">&times;</button>
            </div>
             <div class="p-2 border-b border-gray-700 flex gap-2 text-xs flex-wrap" id="inventory-sort-buttons">
                <button data-sort-category="all" class="px-2 py-1 bg-indigo-600 rounded">Alle</button>
                <button data-sort-category="weapon" class="px-2 py-1 bg-gray-600 rounded">Waffen</button>
                <button data-sort-category="armor" class="px-2 py-1 bg-gray-600 rounded">R√ºstung</button>
                <button data-sort-category="accessory" class="px-2 py-1 bg-gray-600 rounded">Accessoires</button>
                <button data-sort-category="tool" class="px-2 py-1 bg-gray-600 rounded">Werkzeuge</button>
                <button data-sort-category="consumable" class="px-2 py-1 bg-gray-600 rounded">Tr√§nke</button>
                <button data-sort-category="spell" class="px-2 py-1 bg-gray-600 rounded">Zauber</button>
                <button data-sort-category="card" class="px-2 py-1 bg-gray-600 rounded">Karten</button>
                <button data-sort-category="pet" class="px-2 py-1 bg-gray-600 rounded">Pets</button>
            </div>
            <div class="flex p-4 flex-grow gap-4 overflow-hidden">
                <div id="inventory-list-container" class="space-y-3 overflow-y-auto flex-grow pr-2"></div>
                 <div id="inventory-item-details" class="w-2/5 flex-shrink-0 bg-gray-900 p-4 rounded-lg border border-gray-600 flex flex-col">
                 </div>
            </div>
            <div id="inventory-pagination" class="p-2 flex justify-center items-center gap-4 border-t border-gray-700">
                <button id="inventory-page-prev" class="px-3 py-1 bg-indigo-600 rounded disabled:bg-gray-500">&lt;</button>
                <span id="inventory-page-info">Seite 1 / 1</span>
                <button id="inventory-page-next" class="px-3 py-1 bg-indigo-600 rounded disabled:bg-gray-500">&gt;</button>
            </div>
        </div>
    </div>

    <!-- Edit Quest Modal -->
    <div id="edit-quest-modal" class="modal hidden fixed top-1/4 left-1/3 w-[500px] z-40">
        <div class="bg-gray-800 text-white rounded-lg h-full flex flex-col">
            <div class="p-4 pb-2 flex justify-between items-center cursor-move modal-header relative">
                <h3 class="font-bold">Quest bearbeiten</h3>
                <button class="modal-close-btn absolute top-2 right-2 text-2xl font-bold hover:text-red-500">&times;</button>
            </div>
            <div class="p-4 overflow-y-auto">
                <form id="edit-quest-form" class="space-y-3 text-sm">
                    <input type="hidden" id="edit-quest-id">
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Titel</label>
                        <input type="text" id="edit-quest-text" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2" required>
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Beschreibung</label>
                        <textarea id="edit-quest-details" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2 h-20"></textarea>
                    </div>
                    <div class="grid grid-cols-2 gap-4 pt-2">
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1">Priorit√§t</label>
                            <select id="edit-quest-priority" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2"></select>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1">Dauer (Minuten)</label>
                            <input type="number" id="edit-quest-duration" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2" min="0">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1">Deadline</label>
                            <input type="date" id="edit-quest-deadline" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1">Typ</label>
                            <select id="edit-quest-type" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2">
                                <option value="Aufgabe">Aufgabe</option>
                                <option value="Projektaufgabe">Projektaufgabe</option>
                                <option value="Projekt">Projekt</option>
                            </select>
                        </div>
                    </div>
                    <div id="edit-quest-parent-project-container" class="hidden">
                        <label class="block text-xs font-medium text-gray-400 mb-1">√úbergeordnetes Projekt</label>
                        <select id="edit-quest-parent-project" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2"></select>
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Tag</label>
                        <div id="edit-quest-tags-container" class="flex flex-wrap gap-x-4 gap-y-2 p-2 rounded-lg border border-gray-700"></div>
                    </div>
                    <button type="button" class="w-full mt-4 bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg">√Ñnderungen speichern</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Pets Modal -->
    <div id="pets-modal" class="modal hidden fixed top-1/4 left-1/3 w-[800px] z-40">
        <div class="bg-gray-800 text-white rounded-lg h-full flex flex-col">
            <div class="p-4 pb-2 flex justify-between items-center cursor-move modal-header relative">
                <h3 class="font-bold">Meine Pets</h3>
                <button class="modal-close-btn absolute top-2 right-2 text-2xl font-bold hover:text-red-500">&times;</button>
            </div>
            <div class="flex p-4 flex-grow gap-4 overflow-hidden">
                <!-- Left Column: Pet Inventory -->
                <div class="w-2/5 flex flex-col gap-3">
                    <div id="pets-inventory-filters" class="flex-shrink-0 flex gap-2 text-sm">
                        <select id="pet-filter-element" class="flex-grow bg-gray-700 p-1 rounded">
                            <option value="all">Alle Elemente</option>
                            <option value="Erde">Erde</option>
                            <option value="Wasser">Wasser</option>
                            <option value="Schatten">Schatten</option>
                            <option value="Feuer">Feuer</option>
                            <option value="Elektro">Elektro</option>
                            <option value="Eis">Eis</option>
                            <option value="Dunkel">Dunkel</option>
                        </select>
                        <select id="pet-filter-rarity" class="flex-grow bg-gray-700 p-1 rounded">
                            <option value="all">Alle Seltenheiten</option>
                            <option value="common">Gew√∂hnlich</option>
                            <option value="magic">Magisch</option>
                            <option value="rare">Selten</option>
                            <option value="epic">Episch</option>
                        </select>
                    </div>
                    <div id="pets-inventory-list" class="flex-grow space-y-2 overflow-y-auto pr-2">
                        <!-- Pet items will be rendered here -->
                    </div>
                    <div id="pets-inventory-pagination" class="flex-shrink-0 p-2 flex justify-center items-center gap-4 border-t border-gray-700">
                        <button id="pets-page-prev" class="px-3 py-1 bg-indigo-600 rounded disabled:bg-gray-500">&lt;</button>
                        <span id="pets-page-info">Seite 1 / 1</span>
                        <button id="pets-page-next" class="px-3 py-1 bg-indigo-600 rounded disabled:bg-gray-500">&gt;</button>
                    </div>
                </div>
                <!-- Right Column: Details/Comparison -->
                <div id="pets-details-view" class="w-3/5 bg-gray-900 p-4 rounded-lg border border-gray-600 flex flex-col">
                    <!-- Details will be rendered here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Skill Tree Modal -->
    <div id="skill-tree-modal" class="modal hidden fixed top-1/4 left-1/3 w-[800px] h-[70vh] z-40">
        <div class="bg-gray-800 text-white rounded-lg h-full flex flex-col">
             <div class="p-4 pb-2 flex justify-between items-center cursor-move modal-header relative">
                <h3 class="font-bold">Charakter-Skills</h3>
                <button class="modal-close-btn absolute top-2 right-2 text-2xl font-bold hover:text-red-500">&times;</button>
            </div>
            <div class="p-4 border-b border-gray-700 text-center">
                Verf√ºgbare Skill-Punkte: <span id="skill-points-display" class="font-bold text-yellow-400 text-lg">0</span>
            </div>
            <div id="skill-tree-container" class="p-4 flex gap-4 overflow-hidden flex-grow">
                <div id="skill-list-panel" class="w-1/3 space-y-2 overflow-y-auto pr-2 border-r border-gray-600">
                    <!-- Skill icons will be rendered here -->
                </div>
                <div id="skill-detail-panel" class="w-2/3 flex flex-col">
                    <!-- Skill details will be rendered here -->
                </div>
            </div>
            <div class="p-2 border-t border-gray-700 text-right">
                <button id="reset-skills-btn" class="text-xs bg-red-800 hover:bg-red-700 text-white font-bold py-1 px-3 rounded-lg">Skills zur√ºcksetzen (Test)</button>
            </div>
        </div>
    </div>


    <!-- Item Found Modal -->
    <div id="item-found-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-gray-700 p-6 rounded-lg text-center shadow-xl text-white">
            <h3 class="text-xl mb-4">Gegenstand gefunden!</h3>
            <div id="modal-item-icon" class="text-5xl mb-2"></div>
            <p id="modal-item-name" class="font-bold mb-4"></p>
            <div class="flex justify-center gap-4">
                <button id="modal-keep-btn" class="bg-green-500 hover:bg-green-600 px-4 py-2 rounded">Behalten</button>
                <button id="modal-discard-btn" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded">Verwerfen</button>
            </div>
        </div>
    </div>

    <!-- Simple Quest Test Modal -->
    <div id="simple-quest-modal" class="modal hidden fixed top-1/4 left-1/2 w-[400px] z-40">
        <div class="bg-gray-800 text-white rounded-lg h-full flex flex-col">
             <div class="p-4 pb-2 flex justify-between items-center cursor-move modal-header relative">
                <h3 class="font-bold">Simple Quest Test</h3>
                <button class="modal-close-btn absolute top-2 right-2 text-2xl font-bold hover:text-red-500">&times;</button>
            </div>
            <div class="p-4">
                <form id="simple-quest-form" class="space-y-4">
                    <input type="text" id="simple-quest-input" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2" placeholder="Test Quest Titel..." required>
                    <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg">Create Test Quest</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-confirm-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-gray-700 p-6 rounded-lg text-center shadow-xl text-white">
            <h3 class="text-xl mb-4">Wirklich l√∂schen?</h3>
            <p id="delete-confirm-text" class="text-gray-300 mb-4">Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.</p>
            <div class="flex justify-center gap-4">
                <button id="delete-confirm-btn" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded">Ja, l√∂schen</button>
                <button id="delete-cancel-btn" class="bg-gray-500 hover:bg-gray-600 px-4 py-2 rounded">Abbrechen</button>
            </div>
        </div>
    </div>
    
    <!-- Break Popup Modal -->
    <div id="break-popup-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60]">
        <div class="bg-gray-800 p-8 rounded-lg text-center shadow-xl text-white w-96">
            <h3 class="text-2xl font-bold mb-4">Zeit f√ºr eine Pause!</h3>
            <div id="break-timer-display" class="text-7xl font-mono my-6">05:00</div>
            <div class="flex justify-center gap-4 mb-6">
                <button id="extend-break-5-btn" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">+5 Min</button>
                <button id="extend-break-25-btn" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">+25 Min</button>
            </div>
            <button id="close-break-popup-btn" class="text-sm text-gray-400 hover:text-white">Popup schlie√üen (Timer l√§uft weiter)</button>
        </div>
    </div>

    <!-- Post-Break Continue Modal -->
    <div id="post-break-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60]">
        <div class="bg-gray-800 p-8 rounded-lg text-center shadow-xl text-white">
            <h3 class="text-2xl font-bold mb-4">Pause vorbei!</h3>
            <p class="mb-6">Bereit, weiterzumachen?</p>
            <button id="continue-quest-btn" class="bg-green-600 hover:bg-green-700 px-6 py-3 rounded font-bold">Weiter</button>
        </div>
    </div>
    
    <!-- Gantt Test Modal -->
    <div id="gantt-test-modal" class="modal hidden fixed top-1/4 left-1/4 w-[1000px] h-[60vh] z-40">
        <div class="bg-gray-800 text-white rounded-lg h-full flex flex-col">
             <div class="p-4 pb-2 flex justify-between items-center cursor-move modal-header relative">
                <h3 class="font-bold">Gantt Chart (Test)</h3>
                <button class="modal-close-btn absolute top-2 right-2 text-2xl font-bold hover:text-red-500">&times;</button>
            </div>
            <div id="gantt-test-container" class="p-4 flex-grow overflow-auto text-sm"></div>
        </div>
    </div>

    <!-- Main Application Logic -->
    <script type="application/json" id="skills-data">[
      {
        "id": "skill_toughness_1",
        "name": "Z√§higkeit I",
        "description": "Erh√∂ht die maximale HP um 5%.",
        "icon": "‚ù§Ô∏è",
        "levelRequirement": 1,
        "cost": 1,
        "dependencies": []
      },
      {
        "id": "skill_power_strike_1",
        "name": "M√§chtiger Schlag I",
        "description": "Erh√∂ht den physischen Schaden um 5.",
        "icon": "üí™",
        "levelRequirement": 1,
        "cost": 1,
        "dependencies": []
      },
      {
        "id": "skill_toughness_2",
        "name": "Z√§higkeit II",
        "description": "Erh√∂ht die maximale HP um weitere 10%.",
        "icon": "üíñ",
        "levelRequirement": 3,
        "cost": 1,
        "dependencies": ["skill_toughness_1"]
      },
      {
        "id": "skill_power_strike_2",
        "name": "M√§chtiger Schlag II",
        "description": "Erh√∂ht den physischen Schaden um weitere 10.",
        "icon": "üí•",
        "levelRequirement": 3,
        "cost": 2,
        "dependencies": ["skill_power_strike_1"]
      },
      {
        "id": "skill_whirlwind",
        "name": "Wirbelwind",
        "description": "Schaltet eine neue AoE-F√§higkeit frei.",
        "icon": "üå™Ô∏è",
        "levelRequirement": 5,
        "cost": 3,
        "dependencies": ["skill_power_strike_2"]
      },
      {
        "id": "skill_unwavering_defense",
        "name": "Unersch√ºtterliche Verteidigung",
        "description": "Erh√∂ht die Verteidigung um 15.",
        "icon": "üõ°Ô∏è",
        "levelRequirement": 5,
        "cost": 2,
        "dependencies": ["skill_toughness_2"]
      }
    ]</script>
    <script type="module" src="js/main.js"></script>
</body>
</html>
